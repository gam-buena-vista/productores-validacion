<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Búsqueda de Productores</title>
  <link rel="stylesheet" href="estilos.css">
</head>
<body>

  <header>
    <img src="imagen/logogamnegro.png" alt="Logo del Gobierno Autónomo Municipal de Buena Vista" class="logo">
  </header>

  <main class="card">
    <h2>Consulta de Productores</h2>

    <input 
      type="text" 
      id="busqueda" 
      placeholder="Ingrese nombre, apellido, CI, asociación o estado..." 
      class="input-text"
    >
    <button id="btnBuscar" class="btn">Buscar</button>

    <div id="resultados" class="resultados"></div>
  </main>

  <script src="productores.js"></script>
  <script>
    const input = document.getElementById("busqueda");
    const btn = document.getElementById("btnBuscar");
    const resultados = document.getElementById("resultados");

    btn.addEventListener("click", buscarProductor);
    input.addEventListener("keypress", (e) => {
      if (e.key === "Enter") buscarProductor();
    });

    function buscarProductor() {
      const texto = input.value.trim().toLowerCase();
      resultados.innerHTML = "";

      if (texto === "") {
        resultados.innerHTML = "<p class='error'>Ingrese un dato para buscar.</p>";
        return;
      }

      // Buscar coincidencias en cualquier campo
      const encontrados = Object.entries(productores).filter(([codigo, p]) => {
        return (
          p.nombre.toLowerCase().includes(texto) ||
          p.ci.toLowerCase().includes(texto) ||
          p.Asociación.toLowerCase().includes(texto) ||
          p.estado.toLowerCase().includes(texto)
        );
      });

      if (encontrados.length === 0) {
        resultados.innerHTML = "<p class='error'>No se encontró ningún productor.</p>";
        return;
      }

      // Mostrar resultados
      resultados.innerHTML = `<p><strong>${encontrados.length}</strong> resultado(s) encontrado(s):</p><br>`;
      encontrados.forEach(([codigo, p]) => {
        resultados.innerHTML += `
          <div class="resultado-item">
            <p><strong>Nombre:</strong> ${p.nombre}</p>
            <p><strong>CI:</strong> ${p.ci}</p>
            <p><strong>Asociación:</strong> ${p.Asociación}</p>
            <p><strong>Estado:</strong> ${p.estado}</p>
            <p><strong>Código:</strong> ${codigo}</p>
            <a href="index.html?id=${codigo}" class="verificar-link">Verificar credencial 🔍</a>
          </div>
          <hr>
        `;
      });
    }
  </script>

</body>
</html>

